{%- liquid
  assign collection = section.settings.collection
  assign title = section.settings.title
  assign limit = section.settings.products_to_show
  assign columns = section.settings.columns
  assign scheme = section.settings.color_scheme
-%}
<section class="featured-collection section color-{{ scheme }}" aria-labelledby="featured-collection-heading">
  <div class="page-width">
    {%- if title != blank -%}
      <h2 id="featured-collection-heading" class="section__title">{{ title }}</h2>
    {%- endif -%}
    {%- if collection != blank and collection.products_count > 0 -%}
      <ul class="product-grid product-grid--{{ columns }}">
        {%- for product in collection.products limit: limit -%}
          <li class="product-grid__item">
            <article class="product-card">
              <a href="{{ product.url }}" class="product-card__link">
                <span class="visually-hidden">{{ product.title }}</span>
              </a>
              <div class="product-card__media">
                {%- if product.featured_image != blank -%}
                  <img
                    src="{{ product.featured_image | image_url: width: 500 }}"
                    alt="{{ product.featured_image.alt | default: product.title | escape }}"
                    width="500"
                    height="{{ 500 | divided_by: product.featured_image.aspect_ratio | round }}"
                    loading="lazy"
                  >
                {%- endif -%}
              </div>
              <div class="product-card__info">
                <h3 class="product-card__title">{{ product.title }}</h3>
                {%- render 'price', product: product -%}
              </div>
            </article>
          </li>
        {%- endfor -%}
      </ul>
      {%- if section.settings.show_view_all and collection.url != blank -%}
        <p class="section__cta">
          <a href="{{ collection.url }}" class="button button--secondary">View all</a>
        </p>
      {%- endif -%}
    {%- endif -%}
  </div>
</section>

{% schema %}
{
  "name": "Featured collection",
  "settings": [
    { "type": "collection", "id": "collection", "label": "Collection" },
    { "type": "text", "id": "title", "label": "Heading", "default": "Featured collection" },
    { "type": "range", "id": "products_to_show", "label": "Products to show", "min": 2, "max": 12, "step": 1, "default": 4 },
    { "type": "range", "id": "columns", "label": "Columns (desktop)", "min": 2, "max": 4, "step": 1, "default": 4 },
    { "type": "checkbox", "id": "show_view_all", "label": "Show 'View all' button", "default": true },
    { "type": "color_scheme", "id": "color_scheme", "label": "Color scheme" }
  ]
}
{% endschema %}
