{{ 'component-testimonials.css' | asset_url | stylesheet_tag }}

{%- liquid
  assign color_scheme = section.settings.color_scheme
-%}

<section
  class="section testimonials color-scheme-{{ color_scheme }}"
  data-section-id="{{ section.id }}"
  {% render 'util-section-spacing', padding_top: section.settings.padding_top, padding_bottom: section.settings.padding_bottom %}
>
  <div class="page-width">
    {%- if section.settings.heading != blank -%}
      <div class="section__header text-center">
        <h2 class="section__title" {% render 'util-animation', animation: 'fade-up' %}>{{ section.settings.heading }}</h2>
      </div>
    {%- endif -%}

    <div class="testimonials__grid grid grid--{{ section.settings.columns }}" data-animate-stagger>
      {%- for block in section.blocks -%}
        <div class="testimonial-card" {{ block.shopify_attributes }} {% render 'util-animation', animation: 'fade-up', index: forloop.index %}>
          {%- if block.settings.rating > 0 -%}
            <div class="testimonial-card__stars" aria-label="{{ block.settings.rating }} out of 5 stars">
              {%- for i in (1..5) -%}
                <span class="testimonial-card__star{% if i <= block.settings.rating %} testimonial-card__star--filled{% endif %}">
                  {%- render 'util-icon', icon: 'star', size: 16 -%}
                </span>
              {%- endfor -%}
            </div>
          {%- endif -%}
          {%- if block.settings.text != blank -%}
            <blockquote class="testimonial-card__text">{{ block.settings.text }}</blockquote>
          {%- endif -%}
          <div class="testimonial-card__author">
            {%- if block.settings.author != blank -%}
              <cite class="testimonial-card__name">{{ block.settings.author }}</cite>
            {%- endif -%}
            {%- if block.settings.title != blank -%}
              <span class="testimonial-card__role">{{ block.settings.title }}</span>
            {%- endif -%}
          </div>
        </div>
      {%- endfor -%}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Testimonials",
  "class": "testimonials-section",
  "settings": [
    { "type": "text", "id": "heading", "label": "Heading", "default": "What our customers say" },
    {
      "type": "select", "id": "columns", "label": "Columns",
      "options": [
        { "value": "2", "label": "2" },
        { "value": "3", "label": "3" }
      ],
      "default": "3"
    },
    { "type": "color_scheme", "id": "color_scheme", "label": "Color scheme", "default": "scheme-1" },
    { "type": "range", "id": "padding_top", "label": "Top padding", "min": 0, "max": 100, "step": 4, "default": 40, "unit": "px" },
    { "type": "range", "id": "padding_bottom", "label": "Bottom padding", "min": 0, "max": 100, "step": 4, "default": 40, "unit": "px" }
  ],
  "blocks": [
    {
      "type": "testimonial",
      "name": "Testimonial",
      "settings": [
        { "type": "range", "id": "rating", "label": "Star rating", "min": 0, "max": 5, "step": 1, "default": 5 },
        { "type": "richtext", "id": "text", "label": "Text", "default": "<p>This is an amazing product! I love it.</p>" },
        { "type": "text", "id": "author", "label": "Author", "default": "Jane D." },
        { "type": "text", "id": "title", "label": "Author title" }
      ]
    }
  ],
  "max_blocks": 9,
  "presets": [
    {
      "name": "Testimonials",
      "blocks": [
        { "type": "testimonial" },
        { "type": "testimonial" },
        { "type": "testimonial" }
      ]
    }
  ]
}
{% endschema %}
