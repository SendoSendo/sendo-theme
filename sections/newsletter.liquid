{{ 'component-newsletter.css' | asset_url | stylesheet_tag }}

{%- liquid
  assign color_scheme = section.settings.color_scheme
-%}

<section
  class="section newsletter color-scheme-{{ color_scheme }}"
  data-section-id="{{ section.id }}"
  {% render 'util-section-spacing', padding_top: section.settings.padding_top, padding_bottom: section.settings.padding_bottom %}
>
  <div class="page-width">
    <div class="newsletter__inner" {% render 'util-animation', animation: 'fade-up' %}>
      {%- if section.settings.heading != blank -%}
        <h2 class="newsletter__heading">{{ section.settings.heading }}</h2>
      {%- endif -%}
      {%- if section.settings.text != blank -%}
        <p class="newsletter__text">{{ section.settings.text }}</p>
      {%- endif -%}

      {%- form 'customer', class: 'newsletter__form' -%}
        <input type="hidden" name="contact[tags]" value="newsletter">
        {%- if form.errors -%}
          <div class="form__message form__message--error" role="alert">
            <p>{{ form.errors.translated_fields['email'] | capitalize }} {{ form.errors.messages['email'] }}</p>
          </div>
        {%- endif -%}
        {%- if form.posted_successfully? -%}
          <div class="form__message form__message--success" role="status">
            <p>{%- render 'util-icon', icon: 'check', size: 16 -%} {{ 'general.newsletter.success' | t | default: "Thanks for subscribing!" }}</p>
          </div>
        {%- endif -%}
        <div class="newsletter__form-row">
          <div class="field">
            <label for="NewsletterEmail-{{ section.id }}" class="visually-hidden">{{ 'general.newsletter.email_label' | t | default: 'Email address' }}</label>
            <input
              type="email"
              id="NewsletterEmail-{{ section.id }}"
              name="contact[email]"
              class="field__input"
              value="{{ form.email }}"
              placeholder="{{ section.settings.placeholder | default: 'Enter your email' }}"
              required
              autocomplete="email"
              {% if form.errors %}autofocus aria-invalid="true" aria-describedby="Newsletter-error-{{ section.id }}"{% endif %}
            >
          </div>
          <button type="submit" class="btn btn--primary newsletter__button">
            {{ section.settings.button_label | default: 'Subscribe' }}
          </button>
        </div>
      {%- endform -%}

      {%- if section.settings.privacy_note != blank -%}
        <p class="newsletter__privacy">{{ section.settings.privacy_note }}</p>
      {%- endif -%}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Newsletter",
  "class": "newsletter-section",
  "settings": [
    { "type": "text", "id": "heading", "label": "Heading", "default": "Stay in the Loop" },
    { "type": "text", "id": "text", "label": "Text", "default": "Subscribe for exclusive offers, new arrivals, and insider-only discounts." },
    { "type": "text", "id": "placeholder", "label": "Email placeholder", "default": "Enter your email" },
    { "type": "text", "id": "button_label", "label": "Button label", "default": "Subscribe" },
    { "type": "richtext", "id": "privacy_note", "label": "Privacy note" },
    { "type": "color_scheme", "id": "color_scheme", "label": "Color scheme", "default": "scheme-1" },
    { "type": "range", "id": "padding_top", "label": "Top padding", "min": 0, "max": 100, "step": 4, "default": 40, "unit": "px" },
    { "type": "range", "id": "padding_bottom", "label": "Bottom padding", "min": 0, "max": 100, "step": 4, "default": 40, "unit": "px" }
  ],
  "presets": [{ "name": "Newsletter" }]
}
{% endschema %}
